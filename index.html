<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RoZam Studio</title>
  <meta name="description" content="RoZam Studio - Catálogo musical y reproductor estilo Spotify." />

  <style>
    :root{
      --bg:#0b0d12;
      --panel:#111521;
      --panel2:#0f1320;
      --card:#151a2a;
      --card2:#1a2034;
      --text:#ffffff;
      --muted:#a9b0c3;
      --line:rgba(255,255,255,.08);
      --green:#1db954;        /* Spotify-ish */
      --green2:#22c55e;
      --shadow: 0 12px 40px rgba(0,0,0,.45);
      --radius:16px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, Helvetica, sans-serif;
      background: radial-gradient(1200px 700px at 15% 10%, rgba(29,185,84,.18), transparent 55%),
                  radial-gradient(900px 600px at 85% 5%, rgba(88,101,242,.14), transparent 60%),
                  var(--bg);
      color:var(--text);
      overflow:hidden;
    }

    a{color:inherit;text-decoration:none}
    button{font-family:inherit}

    /* Layout */
    .app{
      height:100%;
      display:grid;
      grid-template-columns: 280px 1fr;
      grid-template-rows: 1fr auto;
      gap:0;
    }

    /* Sidebar */
    .sidebar{
      grid-column:1;
      grid-row:1;
      padding:18px 14px 14px;
      background: linear-gradient(180deg, rgba(17,21,33,.92), rgba(11,13,18,.92));
      border-right:1px solid var(--line);
      overflow:auto;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 10px 16px;
    }
    .logo{
      width:38px;height:38px;border-radius:12px;
      background: linear-gradient(135deg, rgba(29,185,84,.95), rgba(88,101,242,.75));
      box-shadow: 0 10px 24px rgba(29,185,84,.18);
      position:relative;
    }
    .logo:after{
      content:"";
      position:absolute; inset:10px;
      border-radius:10px;
      border:2px solid rgba(255,255,255,.25);
    }
    .brand h1{
      margin:0;
      font-size:18px;
      letter-spacing:.6px;
      line-height:1.1;
    }
    .brand small{color:var(--muted);display:block;margin-top:2px}

    .nav{
      margin-top:6px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .nav a{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:12px;
      color:var(--muted);
      background: transparent;
      transition:.15s ease;
    }
    .nav a:hover{
      background: rgba(255,255,255,.06);
      color:#fff;
    }
    .nav a.active{
      background: rgba(29,185,84,.12);
      color:#fff;
      border:1px solid rgba(29,185,84,.22);
    }

    .sectionTitle{
      margin:18px 10px 10px;
      color:rgba(255,255,255,.85);
      font-size:12px;
      letter-spacing:.14em;
      text-transform:uppercase;
    }

    .playlist{
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:0 6px 12px;
    }

    .pill{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.06);
      color:rgba(255,255,255,.9);
    }
    .pill span{color:var(--muted);font-size:12px}

    .tip{
      margin:14px 10px 0;
      padding:12px 12px;
      border-radius:14px;
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.06);
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    /* Main */
    .main{
      grid-column:2;
      grid-row:1;
      display:flex;
      flex-direction:column;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(17,21,33,.55), rgba(11,13,18,.55));
    }

    .topbar{
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      border-bottom:1px solid var(--line);
      backdrop-filter: blur(10px);
    }

    .search{
      flex:1;
      max-width:760px;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.08);
      color:rgba(255,255,255,.9);
    }
    .search input{
      width:100%;
      background:transparent;
      border:0;
      outline:none;
      color:#fff;
      font-size:14px;
    }
    .search input::placeholder{color:rgba(255,255,255,.55)}

    .topActions{
      display:flex; align-items:center; gap:10px;
    }
    .btn{
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color:#fff;
      cursor:pointer;
      transition:.15s ease;
      font-weight:600;
      font-size:13px;
    }
    .btn:hover{background: rgba(255,255,255,.08)}
    .btn.primary{
      border:1px solid rgba(29,185,84,.28);
      background: linear-gradient(135deg, rgba(29,185,84,.95), rgba(34,197,94,.65));
      box-shadow: 0 12px 30px rgba(29,185,84,.14);
    }
    .btn.primary:hover{filter:brightness(1.03)}

    .content{
      padding:18px 18px 96px; /* deja espacio para el player */
      overflow:auto;
    }

    .hero{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:16px;
      padding:18px;
      border-radius: var(--radius);
      background: linear-gradient(135deg, rgba(29,185,84,.16), rgba(88,101,242,.10));
      border:1px solid rgba(255,255,255,.08);
      box-shadow: var(--shadow);
    }
    .hero h2{margin:0;font-size:26px}
    .hero p{margin:6px 0 0;color:var(--muted);max-width:800px;line-height:1.35}
    .hero .meta{
      display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;
      color:rgba(255,255,255,.85);
      font-size:13px;
    }
    .badge{
      padding:6px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
    }

    .gridTitle{
      margin:18px 2px 10px;
      display:flex; align-items:baseline; justify-content:space-between;
    }
    .gridTitle h3{margin:0;font-size:16px}
    .gridTitle span{color:var(--muted);font-size:13px}

    .cards{
      display:grid;
      grid-template-columns: repeat(4, minmax(180px, 1fr));
      gap:12px;
    }
    @media (max-width:1100px){ .cards{grid-template-columns: repeat(3, minmax(180px, 1fr));} }
    @media (max-width:900px){
      .app{grid-template-columns: 1fr}
      .sidebar{display:none}
      .main{grid-column:1}
      .cards{grid-template-columns: repeat(2, minmax(160px, 1fr));}
    }
    @media (max-width:520px){ .cards{grid-template-columns: 1fr;} }

    .card{
      padding:12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(21,26,42,.95), rgba(15,19,32,.9));
      border:1px solid rgba(255,255,255,.08);
      transition:.15s ease;
      cursor:pointer;
      position:relative;
      overflow:hidden;
      min-height:170px;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: rgba(29,185,84,.22);
      box-shadow: 0 16px 40px rgba(0,0,0,.35);
    }

    .cover{
      width:100%;
      aspect-ratio:1/1;
      border-radius:14px;
      background:
        radial-gradient(120px 120px at 30% 30%, rgba(29,185,84,.35), transparent 55%),
        radial-gradient(140px 140px at 70% 20%, rgba(88,101,242,.25), transparent 60%),
        linear-gradient(135deg, rgba(255,255,255,.10), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.10);
      position:relative;
      overflow:hidden;
    }
    .cover:after{
      content:"";
      position:absolute; inset:-40px;
      background: linear-gradient(120deg, rgba(255,255,255,.10), transparent 60%);
      transform: rotate(20deg);
    }

    .card h4{
      margin:10px 0 0;
      font-size:14px;
      line-height:1.2;
    }
    .card p{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.25;
    }

    .playFloat{
      position:absolute;
      right:12px;
      bottom:78px;
      width:44px;height:44px;
      border-radius:999px;
      border:0;
      cursor:pointer;
      background: var(--green);
      display:grid;
      place-items:center;
      box-shadow: 0 14px 30px rgba(29,185,84,.22);
      opacity:0;
      transform: translateY(8px);
      transition:.15s ease;
    }
    .card:hover .playFloat{
      opacity:1;
      transform: translateY(0);
    }

    /* Track list */
    .tracksWrap{
      margin-top:14px;
      border-radius: var(--radius);
      background: rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.08);
      overflow:hidden;
    }
    table{
      width:100%;
      border-collapse:collapse;
    }
    thead th{
      text-align:left;
      font-size:12px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:rgba(255,255,255,.65);
      padding:12px 12px;
      border-bottom:1px solid var(--line);
      background: rgba(0,0,0,.12);
    }
    tbody td{
      padding:12px 12px;
      border-bottom:1px solid rgba(255,255,255,.06);
      color:rgba(255,255,255,.90);
      font-size:14px;
    }
    tbody tr{
      cursor:pointer;
      transition:.12s ease;
    }
    tbody tr:hover{background: rgba(29,185,84,.08)}
    tbody tr.active{background: rgba(29,185,84,.14)}
    .tdMuted{color:var(--muted);font-size:13px}

    /* Bottom Player */
    .player{
      grid-column:1 / -1;
      grid-row:2;
      border-top:1px solid var(--line);
      background: rgba(10,12,16,.92);
      backdrop-filter: blur(12px);
      padding:10px 12px;
      display:grid;
      grid-template-columns: 1.2fr 1.6fr 1.2fr;
      align-items:center;
      gap:10px;
    }
    @media (max-width:900px){
      .player{grid-template-columns: 1fr}
    }

    .now{
      display:flex; align-items:center; gap:10px;
      min-width: 0;
    }
    .now .mini{
      width:46px;height:46px;border-radius:12px;
      background: linear-gradient(135deg, rgba(29,185,84,.25), rgba(88,101,242,.18));
      border:1px solid rgba(255,255,255,.10);
      flex:0 0 auto;
    }
    .now .txt{
      min-width:0;
    }
    .now .txt .t{
      font-weight:700;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .now .txt .a{
      margin-top:2px;
      color:var(--muted);
      font-size:12px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .controls{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
    }
    .ctrlRow{
      display:flex; gap:10px; align-items:center; justify-content:center;
    }
    .iconBtn{
      width:36px;height:36px;border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color:#fff;
      cursor:pointer;
      transition:.12s ease;
      display:grid;
      place-items:center;
    }
    .iconBtn:hover{background: rgba(255,255,255,.08)}
    .iconBtn.play{
      width:42px;height:42px;
      background: var(--green);
      border-color: rgba(0,0,0,.12);
      color:#07110a;
      font-weight:800;
    }

    .seekRow{
      width:100%;
      display:flex;
      align-items:center;
      gap:10px;
      color:rgba(255,255,255,.65);
      font-size:12px;
    }
    input[type="range"]{
      width:100%;
      accent-color: var(--green);
    }

    .right{
      display:flex;
      align-items:center;
      justify-content:flex-end;
      gap:10px;
      color:rgba(255,255,255,.9);
    }
    .vol{
      width:140px;
      max-width: 32vw;
    }

    /* Small SVG icons */
    .svg{width:16px;height:16px;fill:currentColor}
    .svgBig{width:18px;height:18px;fill:currentColor}
  </style>
</head>

<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>RoZam Studio</h1>
          <small>Catálogo & Player</small>
        </div>
      </div>

      <nav class="nav">
        <a class="active" href="#" onclick="return false;">
          <span>Inicio</span>
        </a>
        <a href="#" onclick="return false;">
          <span>Buscar</span>
        </a>
        <a href="#" onclick="return false;">
          <span>Tu biblioteca</span>
        </a>
      </nav>

      <div class="sectionTitle">Colecciones</div>
      <div class="playlist">
        <div class="pill">
          <div>
            <div style="font-weight:700">RoZam Studio Hits</div>
            <span>Selección principal</span>
          </div>
          <span id="countTracks">0</span>
        </div>
        <div class="pill">
          <div>
            <div style="font-weight:700">Banda / Norteño</div>
            <span>Regional mexicano</span>
          </div>
          <span>Mix</span>
        </div>
        <div class="pill">
          <div>
            <div style="font-weight:700">Cumbia Sonidera</div>
            <span>Épica & bailable</span>
          </div>
          <span>Mix</span>
        </div>
      </div>

      <div class="tip">
        <strong style="color:#fff">Tip:</strong>
        Pon tus MP3 en la misma carpeta que este <em>index.html</em>.
        Luego agrega más canciones en la lista del código (arreglo <em>tracks</em>).
      </div>
    </aside>

    <!-- Main -->
    <main class="main">
      <div class="topbar">
        <div class="search">
          <svg class="svg" viewBox="0 0 24 24" aria-hidden="true"><path d="M10 4a6 6 0 104.472 10.027l4.25 4.25 1.414-1.414-4.25-4.25A6 6 0 0010 4zm0 2a4 4 0 110 8 4 4 0 010-8z"/></svg>
          <input id="searchInput" type="text" placeholder="Busca canción, artista o género..." />
        </div>
        <div class="topActions">
          <button class="btn" id="shuffleBtn" title="Shuffle">Shuffle</button>
          <button class="btn primary" id="playAllBtn">Reproducir</button>
        </div>
      </div>

      <div class="content">
        <section class="hero">
          <div>
            <h2>RoZam Studio</h2>
            <p>Tu catálogo independiente con una estética tipo Spotify. Reproductor integrado, lista de canciones y tarjetas estilo “álbum”.</p>
            <div class="meta">
              <span class="badge">Diseño oscuro</span>
              <span class="badge">Player abajo</span>
              <span class="badge">Lista editable</span>
            </div>
          </div>
          <div style="text-align:right">
            <div style="color:rgba(255,255,255,.75);font-size:13px">Estado</div>
            <div style="font-size:22px;font-weight:800;color:var(--green)">En vivo</div>
          </div>
        </section>

        <div class="gridTitle">
          <h3>Destacadas</h3>
          <span id="resultInfo">Mostrando todo</span>
        </div>

        <section class="cards" id="cards"></section>

        <div class="gridTitle" style="margin-top:18px">
          <h3>Lista de canciones</h3>
          <span>Click para reproducir</span>
        </div>

        <div class="tracksWrap">
          <table>
            <thead>
              <tr>
                <th style="width:48px">#</th>
                <th>Título</th>
                <th>Artista</th>
                <th style="width:120px">Género</th>
                <th style="width:100px">Duración</th>
              </tr>
            </thead>
            <tbody id="trackTable"></tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- Bottom player -->
    <footer class="player">
      <div class="now">
        <div class="mini" aria-hidden="true"></div>
        <div class="txt">
          <div class="t" id="nowTitle">Nada sonando</div>
          <div class="a" id="nowArtist">RoZam Studio</div>
        </div>
      </div>

      <div class="controls">
        <div class="ctrlRow">
          <button class="iconBtn" id="prevBtn" title="Anterior">
            <svg class="svgBig" viewBox="0 0 24 24"><path d="M6 5h2v14H6V5zm3.5 7l10 7V5l-10 7z"/></svg>
          </button>

          <button class="iconBtn play" id="playBtn" title="Play/Pause">
            <span id="playIcon">▶</span>
          </button>

          <button class="iconBtn" id="nextBtn" title="Siguiente">
            <svg class="svgBig" viewBox="0 0 24 24"><path d="M16 5h2v14h-2V5zM5 19l10-7L5 5v14z"/></svg>
          </button>
        </div>

        <div class="seekRow">
          <span id="curTime">0:00</span>
          <input id="seek" type="range" min="0" max="100" value="0" />
          <span id="durTime">0:00</span>
        </div>
      </div>

      <div class="right">
        <span style="color:rgba(255,255,255,.7);font-size:12px">Vol</span>
        <input class="vol" id="vol" type="range" min="0" max="1" step="0.01" value="0.9" />
      </div>

      <audio id="audio"></audio>
    </footer>
  </div>

  <script>
    // =========================
    // 1) TU LISTA DE CANCIONES
    // =========================
    // Pon tus MP3 en la misma carpeta que este index.html y edita "src".
    // Ejemplo: "La Botella Me Escucha (1).mp3"
    const tracks = [
      {
        title: "La Botella Me Escucha",
        artist: "RoZam Studio",
        genre: "Banda / Regional",
        src: "La Botella Me Escucha (1).mp3",
        coverLabel: "Single"
      },
      // Agrega más así:
      // { title:"...", artist:"RoZam Studio", genre:"Cumbia Sonidera", src:"archivo.mp3", coverLabel:"EP" },
    ];

    // =========================
    // 2) ELEMENTOS
    // =========================
    const audio = document.getElementById("audio");
    const cards = document.getElementById("cards");
    const trackTable = document.getElementById("trackTable");
    const nowTitle = document.getElementById("nowTitle");
    const nowArtist = document.getElementById("nowArtist");
    const playBtn = document.getElementById("playBtn");
    const playIcon = document.getElementById("playIcon");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const seek = document.getElementById("seek");
    const vol = document.getElementById("vol");
    const curTime = document.getElementById("curTime");
    const durTime = document.getElementById("durTime");
    const searchInput = document.getElementById("searchInput");
    const resultInfo = document.getElementById("resultInfo");
    const countTracks = document.getElementById("countTracks");
    const playAllBtn = document.getElementById("playAllBtn");
    const shuffleBtn = document.getElementById("shuffleBtn");

    let currentIndex = -1;
    let isSeeking = false;
    let filteredIdx = tracks.map((_, i) => i);

    // =========================
    // 3) RENDER
    // =========================
    function renderAll(){
      countTracks.textContent = tracks.length;
      renderCards();
      renderTable();
    }

    function renderCards(){
      cards.innerHTML = "";
      filteredIdx.forEach((idx) => {
        const t = tracks[idx];
        const el = document.createElement("div");
        el.className = "card";
        el.innerHTML = `
          <div class="cover" aria-hidden="true"></div>
          <h4>${escapeHtml(t.title)}</h4>
          <p>${escapeHtml(t.artist)} • <span class="tdMuted">${escapeHtml(t.genre)}</span></p>
          <button class="playFloat" title="Reproducir">
            <svg class="svgBig" viewBox="0 0 24 24" style="fill:#07110a">
              <path d="M8 5v14l11-7z"></path>
            </svg>
          </button>
        `;
        el.addEventListener("click", (e) => {
          // Si presionan el botón o la tarjeta, reproduce igual
          playByIndex(idx);
        });
        cards.appendChild(el);
      });
    }

    function renderTable(){
      trackTable.innerHTML = "";
      filteredIdx.forEach((idx, i) => {
        const t = tracks[idx];
        const tr = document.createElement("tr");
        tr.dataset.idx = idx;
        tr.innerHTML = `
          <td class="tdMuted">${i + 1}</td>
          <td><strong>${escapeHtml(t.title)}</strong></td>
          <td class="tdMuted">${escapeHtml(t.artist)}</td>
          <td class="tdMuted">${escapeHtml(t.genre)}</td>
          <td class="tdMuted" id="dur-${idx}">—</td>
        `;
        tr.addEventListener("click", () => playByIndex(idx));
        trackTable.appendChild(tr);

        // Calcula duración (si el navegador puede leer el archivo)
        probeDuration(idx);
      });

      highlightActiveRow();
    }

    function highlightActiveRow(){
      [...trackTable.querySelectorAll("tr")].forEach(tr => {
        tr.classList.toggle("active", Number(tr.dataset.idx) === currentIndex);
      });
    }

    // =========================
    // 4) PLAYER
    // =========================
    function playByIndex(idx){
      if (!tracks[idx]) return;

      currentIndex = idx;
      audio.src = tracks[idx].src;
      audio.play().catch(() => {
        // A veces el navegador bloquea autoplay. El botón play lo desbloquea.
      });

      nowTitle.textContent = tracks[idx].title;
      nowArtist.textContent = tracks[idx].artist;
      playIcon.textContent = "❚❚";

      highlightActiveRow();
    }

    function togglePlay(){
      if (currentIndex === -1 && tracks.length) {
        playByIndex(filteredIdx[0] ?? 0);
        return;
      }
      if (audio.paused) {
        audio.play().catch(()=>{});
        playIcon.textContent = "❚❚";
      } else {
        audio.pause();
        playIcon.textContent = "▶";
      }
    }

    function next(){
      if (!filteredIdx.length) return;
      const pos = filteredIdx.indexOf(currentIndex);
      const nextPos = (pos >= 0) ? (pos + 1) % filteredIdx.length : 0;
      playByIndex(filteredIdx[nextPos]);
    }

    function prev(){
      if (!filteredIdx.length) return;
      const pos = filteredIdx.indexOf(currentIndex);
      const prevPos = (pos >= 0) ? (pos - 1 + filteredIdx.length) % filteredIdx.length : 0;
      playByIndex(filteredIdx[prevPos]);
    }

    // =========================
    // 5) EVENTS
    // =========================
    playBtn.addEventListener("click", togglePlay);
    nextBtn.addEventListener("click", next);
    prevBtn.addEventListener("click", prev);

    vol.addEventListener("input", () => {
      audio.volume = Number(vol.value);
    });

    seek.addEventListener("input", () => {
      isSeeking = true;
      const pct = Number(seek.value) / 100;
      if (!isNaN(audio.duration)) {
        audio.currentTime = pct * audio.duration;
      }
    });
    seek.addEventListener("change", () => { isSeeking = false; });

    audio.addEventListener("timeupdate", () => {
      if (!isSeeking && !isNaN(audio.duration)) {
        const pct = (audio.currentTime / audio.duration) * 100;
        seek.value = String(pct);
      }
      curTime.textContent = fmtTime(audio.currentTime);
    });

    audio.addEventListener("loadedmetadata", () => {
      durTime.textContent = fmtTime(audio.duration);
    });

    audio.addEventListener("ended", () => {
      next();
    });

    playAllBtn.addEventListener("click", () => {
      if (!filteredIdx.length) return;
      playByIndex(filteredIdx[0]);
    });

    shuffleBtn.addEventListener("click", () => {
      // Fisher-Yates shuffle de filteredIdx
      for (let i = filteredIdx.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [filteredIdx[i], filteredIdx[j]] = [filteredIdx[j], filteredIdx[i]];
      }
      renderCards();
      renderTable();
      resultInfo.textContent = "Shuffle activo";
    });

    searchInput.addEventListener("input", () => {
      const q = searchInput.value.trim().toLowerCase();
      if (!q) {
        filteredIdx = tracks.map((_, i) => i);
        resultInfo.textContent = "Mostrando todo";
      } else {
        filteredIdx = tracks
          .map((t, i) => ({ t, i }))
          .filter(x =>
            (x.t.title || "").toLowerCase().includes(q) ||
            (x.t.artist || "").toLowerCase().includes(q) ||
            (x.t.genre || "").toLowerCase().includes(q)
          )
          .map(x => x.i);
        resultInfo.textContent = `Resultados: ${filteredIdx.length}`;
      }
      renderCards();
      renderTable();
    });

    // =========================
    // 6) HELPERS
    // =========================
    function fmtTime(sec){
      if (!isFinite(sec)) return "0:00";
      const m = Math.floor(sec / 60);
      const s = Math.floor(sec % 60);
      return `${m}:${String(s).padStart(2,"0")}`;
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, (m) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
      }[m]));
    }

    function probeDuration(idx){
      // Intenta cargar metadata para mostrar duración en la tabla
      const t = tracks[idx];
      const a = new Audio();
      a.src = t.src;
      a.addEventListener("loadedmetadata", () => {
        const td = document.getElementById(`dur-${idx}`);
        if (td) td.textContent = fmtTime(a.duration);
      });
      a.addEventListener("error", () => {
        // Si no encuentra el archivo, se queda en "—"
      });
    }

    // Start
    renderAll();
    audio.volume = Number(vol.value);
  </script>
</body>
</html>
